// index.js
const { Client, LocalAuth } = require('whatsapp-web.js');
const qrcode = require('qrcode-terminal');

// Initialisation du bot avec authentification locale
const client = new Client({
    authStrategy: new LocalAuth()
});

// Affiche un QR Code dans le terminal pour lier ton WhatsApp
client.on('qr', qr => {
    qrcode.generate(qr, {small: true});
});

// Quand le bot est prÃªt
client.on('ready', () => {
    console.log('âœ… Bot WhatsApp connectÃ© et prÃªt !');
});

// Commande : !tagall
client.on('message', async msg => {
    if (msg.body.toLowerCase() === '!tagall') {
        const chat = await msg.getChat();

        if (chat.isGroup) {
            let text = 'ðŸ‘¥ @all\n\n';
            let mentions = [];

            for (let participant of chat.participants) {
                const contact = await client.getContactById(participant.id._serialized);
                mentions.push(contact);
                text += `@${participant.id.user} `;
            }

            await chat.sendMessage(text, { mentions });
        }
    }
});

client.initialize();
